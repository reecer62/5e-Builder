<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>5e Builder</title>
	<script type="text/javascript" src="loadDir.js"></script>
	<script type="text/javascript" src="jump.js"></script>
	<script>
		var sel;
		var plist;

		function boxy(val){
			console.log(val)
			let mao = loadDir[sel].tool_proficiency
			let funbox = 0
			let cheks = document.getElementByTagName("input")
			for (var i =0;i<cheks.length;i++){
				if ( funbox >= mao.num && !(mao.options[i] === val)){
					cheks[i].checked = false;
				} else if (!(mao.options[i] === val)){
					funbox++;
				}
			}
			

		}
		function raceSel() {
			var tmp = document.getElementById("races").value
			var raceList = loadDir("./races");
			var cur;
			for ( var i =0; i< raceList.length; i++){
				if ( tmp === raceList[i].race_name){
					sel = i;
					break;
				}
			}
			
			var statList = document.getElementById("stats")
			//clear statlist
			statList.innerHTML =''
			for (var i =0; i< raceList[sel].ability_score_increase.length; i++){
				let box = document.createElement('li')
				box.appendChild(document.createTextNode(raceList[sel].ability_score_increase[i].stat + ":" + (raceList[sel].ability_score_increase[i].mod > 0? "+":"") + raceList[sel].ability_score_increase[i].mod))
				statList.appendChild(box);
			}


	
			var profList = document.getElementById("prof")
			//clear statlist
			profList.innerHTML =''
			for (var i =0; i< raceList[sel].weapon_proficiencies.length; i++){
				let box = document.createElement('li')
				box.appendChild(document.createTextNode(raceList[sel].weapon_proficiencies[i]))
				profList.appendChild(box);
			}
			for (var i =0; i< raceList[sel].armor_proficiencies.length; i++){
				let box = document.createElement('li')
				box.appendChild(document.createTextNode(raceList[sel].armor_proficiencies[i]))
				profList.appendChild(box);
			}
			var optList = document.getElementById("opt")
			//clear statlist
			optList.innerHTML = ''
			plist = []
			for (var i =0; i< raceList[sel].tool_proficiency.options.length; i++){
				let box = document.createElement('li')
				let corpseweaver = document.createElement('input')
				corpseweaver.type = "checkbox"
				corpseweaver.value = raceList[sel].tool_proficiency.options[i];
				corpseweaver.onchange = 'boxy(raceList[sel].tool_proficiency.options[i])';
				let orely = document.createTextNode(raceList[sel].tool_proficiency.options[i])
				box.appendChild(orely)
				box.appendChild(corpseweaver)
				console.log(corpseweaver)
				optList.appendChild(box);
			}
		
			
			
			
		}
	</script>
  </head>
  <body>

    <header>
      <h1>Character Creation</h1>
    </header>
	<select id="races" onclick="raceSel()">
	</select>
	<h2> Abillity Score increases </h2>
	<ul id="stats"> </ul>
	<h2> Proficiencies </h2>
	<ul id="prof"> </ul>
	<h2> Optional Proficencies </h2>
	<ul id="opt"> </ul>
	<div id="traits"></div>
	<script>
		//Populate the race drop down menu
		var scroll = document.getElementById("races");
		var raceList = loadDir("./races");
		for ( var i = 0; i < raceList.length;i++){
			var cur = document.createElement('option')
			cur.value = raceList[i].race_name
			cur.innerHTML = raceList[i].race_name
			//cur.id = "opt" + raceList[i].race_name
			scroll.appendChild(cur)
		}
	</script>
	<!-- <button style="background:blue; color:white"  id="raceDone" onclick="jumpAndSave('createHome.html','race',sel)" > Take Race </button> <br> -->
	<button style="background:blue; color:white"  id="raceDone" onclick="console.log(sel)" > Take Race </button> <br>
  </body>
</html>
